(function(){var t,e=[].slice;t={els:".js-crispy",images:[],breakpoints:["32em","48em","62em","76em"],debugMode:!0,debug:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.debugMode&&"undefined"!=typeof console&&null!==console?null!=console.log.apply?console.log.apply(console,t):console.log(t):void 0},init:function(){return this.debug("Initialising crispy"),this.currentBreakpoint=this.getCurrentBreakpoint(),this.gather(),this.bind()},bind:function(){var t=this;return $(window).smartresize(function(){return t.refreshImages()})},windowWidth:function(){return $(window).width()/Number($("body").css("font-size"))},getCurrentBreakpoint:function(){var t,e,r,n,i,a;for(t=this.breakpoints[0],a=this.breakpoints,r=function(e){return window.matchMedia&&window.matchMedia("all and (min-width: "+e+")").matches?t=e:void 0},n=0,i=a.length;i>n;n++)e=a[n],r(e);return this.debug(t),t},testBreakpointChange:function(){var t;return t=this.getCurrentBreakpoint(),this.currentBreakpoint===t?!1:(this.currentBreakpoint=t,!0)},refreshImages:function(){return this.testBreakpointChange()?(this.debug("Breakpoint change"),this.gather()):void 0},gather:function(){var t,e,r,n;for(e=$(this.els),this.debug(e.length,"images found"),this.images=[],r=0,n=e.length;n>r;r++)t=e[r],this.add(t);return this.grabFromServer()},add:function(t){return t=$(t),this.images.push({src:t.attr("data-src"),width:t.width()})},buildQuery:function(){var t,e,r,n,i,a;for(t=function(t,e){return e+="image[]="+t.src+"&width[]="+t.width+"&"},e="",a=this.images,n=0,i=a.length;i>n;n++)r=a[n],e=t(r,e);return e=e.slice(0,-1)},grabFromServer:function(){var t,e=this;return this.debug("Grabbing images from server"),t=this.buildQuery(),$.ajax({type:"POST",url:"resize.php",data:t,success:function(t){var r,n,i;for(n=0,i=t.length;i>n;n++)r=t[n],e.loadImage(r);return!0}})},loadImage:function(t){var e,r,n=this;return this.debug("Loading image"),e=$("[data-src='"+t.og_src+"']"),r=$("<img />"),r.attr("src",t.src).attr("alt",e.attr("data-alt")),e.children("img").length?(this.debug("Already have an img"),e.children("img").attr("src",t.src)):r.load(function(){return n.debug("Adding img to page"),e.append(r),e.addClass("img-loaded")})}},$(document).ready(function(){return $(".wrap").removeClass("no-js").addClass("js"),t.init()})}).call(this);